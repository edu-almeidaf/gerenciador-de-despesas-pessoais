import{$ as a}from"./auth-Dh7lbV3Z.js";const d={patterns:{email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,nome:/^[a-zA-ZÀ-ÿ]+([\s'-][a-zA-ZÀ-ÿ]+)*$/},validarEmail:function(e){if(!e||e.trim()==="")return{valido:!1,mensagem:"O e-mail é obrigatório"};if(e=e.trim().toLowerCase(),e.length>254)return{valido:!1,mensagem:"O e-mail é muito longo"};if(!this.patterns.email.test(e))return{valido:!1,mensagem:"Digite um e-mail válido (ex: usuario@email.com)"};const t=e.split("@");return t[1]&&!t[1].includes(".")?{valido:!1,mensagem:"O domínio do e-mail parece inválido"}:{valido:!0,mensagem:""}},validarNome:function(e){return!e||e.trim()===""?{valido:!1,mensagem:"O nome é obrigatório"}:(e=e.trim(),e.length<3?{valido:!1,mensagem:"O nome deve ter pelo menos 3 caracteres"}:e.length>100?{valido:!1,mensagem:"O nome é muito longo"}:this.patterns.nome.test(e)?e.split(/\s+/).filter(o=>o.length>0).length<2?{valido:!1,mensagem:"Digite seu nome completo (nome e sobrenome)"}:{valido:!0,mensagem:""}:{valido:!1,mensagem:"O nome deve conter apenas letras e espaços"})},validarSenha:function(e,t="medio"){if(!e)return{valido:!1,mensagem:"A senha é obrigatória",forca:0};let o=0;const r=[];if(e.length>=6&&(o+=1),e.length>=8&&(o+=1),e.length>=12&&(o+=1),/[a-z]/.test(e)&&(o+=1),/[A-Z]/.test(e)&&(o+=1),/[0-9]/.test(e)&&(o+=1),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)&&(o+=1),t==="basico"){if(e.length<6)return{valido:!1,mensagem:"A senha deve ter pelo menos 6 caracteres",forca:o}}else if(t==="medio"){if(e.length<6&&r.push("pelo menos 6 caracteres"),/[a-zA-Z]/.test(e)||r.push("pelo menos uma letra"),/[0-9]/.test(e)||r.push("pelo menos um número"),r.length>0)return{valido:!1,mensagem:`A senha deve conter: ${r.join(", ")}`,forca:o}}else if(t==="forte"&&(e.length<8&&r.push("pelo menos 8 caracteres"),/[a-z]/.test(e)||r.push("uma letra minúscula"),/[A-Z]/.test(e)||r.push("uma letra maiúscula"),/[0-9]/.test(e)||r.push("um número"),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)||r.push("um caractere especial (!@#$%...)"),r.length>0))return{valido:!1,mensagem:`A senha deve conter: ${r.join(", ")}`,forca:o};return{valido:!0,mensagem:"",forca:o}},validarConfirmacaoSenha:function(e,t){return t?e!==t?{valido:!1,mensagem:"As senhas não coincidem"}:{valido:!0,mensagem:""}:{valido:!1,mensagem:"Confirme sua senha"}},getForcaSenha:function(e){if(!e||e.length===0)return{nivel:"",porcentagem:0,cor:""};let t=0;e.length>=6&&(t+=1),e.length>=8&&(t+=1),e.length>=10&&(t+=1),e.length>=12&&(t+=1),/[a-z]/.test(e)&&(t+=1),/[A-Z]/.test(e)&&(t+=1),/[0-9]/.test(e)&&(t+=1),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)&&(t+=2),/^[a-zA-Z]+$/.test(e)&&(t-=1),/^[0-9]+$/.test(e)&&(t-=2),/(.)\1{2,}/.test(e)&&(t-=1);const r=Math.max(0,Math.min(100,t/10*100));let i,s;return r<33?(i="Fraca",s="error"):r<66?(i="Média",s="warning"):(i="Forte",s="success"),{nivel:i,porcentagem:r,cor:s}}};function l(e,t){const o=e.attr("id");let r=a(`#${o}-erro`);r.length||(r=a(`<span id="${o}-erro" class="text-xs text-red-500 mt-1"></span>`),e.closest(".form-control").append(r)),r.text(t).removeClass("hidden"),e.addClass("input-error").removeClass("input-success")}function n(e){const t=e.attr("id");a(`#${t}-erro`).addClass("hidden"),e.removeClass("input-error")}function f(e){n(e),e.addClass("input-success")}function m(e,t,o,r){e.on("blur",function(){const i=a(this).val();if(i.length>0){const s=t(i);s.valido?(f(a(this)),o[r]=!0):(l(a(this),s.mensagem),o[r]=!1)}}),e.on("input",function(){n(a(this))})}function c(e){a(e).on("focus",function(){a(this).closest(".form-control").addClass("scale-[1.01]")}).on("blur",function(){a(this).closest(".form-control").removeClass("scale-[1.01]")})}const g={mostrarErro:l,limparErro:n,marcarValido:f,configurarValidacao:m,configurarEfeitoFoco:c};export{g as I,d as V};
