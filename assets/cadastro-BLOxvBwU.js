import{$ as e,A as $,F as c,B as k}from"./auth-CObdSabB.js";import{V as r}from"./validacao-Cer_6H4h.js";e(document).ready(function(){$.redirecionarSeLogado();function g(){const s=e("#nome").val().trim(),a=e("#email").val().trim(),o=e("#password").val(),n=e("#confirm-password").val(),t=e("#termos").is(":checked"),i=s.length>0&&a.length>0&&o.length>0&&n.length>0&&t;e("#btn-submit").prop("disabled",!i)}e("#nome, #email, #password, #confirm-password").on("input",g),e("#termos").on("change",g);function m(s,a){const o=s.attr("id");let n=e(`#${o}-erro`);n.length||(n=e(`<span id="${o}-erro" class="text-xs text-red-500 mt-1"></span>`),s.closest(".form-control").append(n)),n.text(a).removeClass("hidden"),s.addClass("input-error").removeClass("input-success")}function d(s){const a=s.attr("id");e(`#${a}-erro`).addClass("hidden"),s.removeClass("input-error")}function u(s){d(s),s.addClass("input-success")}e("#nome").on("blur",function(){const s=e(this).val(),a=e(this);if(s.length>0){const o=r.validarNome(s);o.valido?u(a):m(a,o.mensagem)}}),e("#nome").on("input",function(){d(e(this))}),e("#email").on("blur",function(){const s=e(this).val(),a=e(this);if(s.length>0){const o=r.validarEmail(s);o.valido?u(a):m(a,o.mensagem)}}),e("#email").on("input",function(){d(e(this))}),e("#password").on("input",function(){const s=e(this).val(),a=e(this),o=e("#senha-forca"),n=e("#senha-requisitos");if(d(a),s.length===0){o.css("display","none"),n.addClass("hidden");return}o.css("display","flex");const t=r.getForcaSenha(s),i=o.find("progress"),l=o.find("span");i.val(t.porcentagem),i.removeClass("progress-error").removeClass("progress-warning").removeClass("progress-success").addClass(`progress-${t.cor}`),l.text(t.nivel).removeClass("text-red-500").removeClass("text-yellow-600").removeClass("text-green-600"),t.cor==="error"?l.addClass("text-red-500"):t.cor==="warning"?l.addClass("text-yellow-600"):l.addClass("text-green-600"),r.validarSenha(s,"medio").valido,S(s),e("#confirm-password").val().length>0&&h()}),e("#password").on("blur",function(){const s=e(this).val(),a=e(this);if(s.length>0){const o=r.validarSenha(s,"medio");o.valido?u(a):m(a,o.mensagem)}});function S(s){const a=e("#senha-requisitos");if(!a.length)return;a.removeClass("hidden");const o={tamanho:s.length>=6,letra:/[a-zA-Z]/.test(s),numero:/[0-9]/.test(s),especial:/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(s)};Object.keys(o).forEach(n=>{const t=e(`#req-${n}`);t.length&&(o[n]?(t.removeClass("text-zinc-400").addClass("text-green-600"),t.find("svg").html('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>')):(t.removeClass("text-green-600").addClass("text-zinc-400"),t.find("svg").html('<circle cx="12" cy="12" r="10"/>')))})}function h(){const s=e("#password").val(),a=e("#confirm-password").val(),o=e("#confirm-password");if(a.length>0){const n=r.validarConfirmacaoSenha(s,a);n.valido?u(o):m(o,n.mensagem)}}e("#confirm-password").on("input",function(){d(e(this)),h()}),e("#confirm-password").on("blur",function(){h()}),e("#form-cadastro").on("submit",function(s){s.preventDefault();const a=e(this),o=a.find('button[type="submit"]'),n=e("#nome").val().trim(),t=e("#email").val().trim(),i=e("#password").val(),l=e("#confirm-password").val(),C=e("#termos").is(":checked");c.limpar("mensagem-feedback"),e(".input").removeClass("input-error");const p=r.validarNome(n);if(!p.valido){c.erro("mensagem-feedback",p.mensagem),e("#nome").addClass("input-error").focus();return}const b=r.validarEmail(t);if(!b.valido){c.erro("mensagem-feedback",b.mensagem),e("#email").addClass("input-error").focus();return}const w=r.validarSenha(i,"medio");if(!w.valido){c.erro("mensagem-feedback",w.mensagem),e("#password").addClass("input-error").focus();return}const x=r.validarConfirmacaoSenha(i,l);if(!x.valido){c.erro("mensagem-feedback",x.mensagem),e("#confirm-password").addClass("input-error").focus();return}if(!C){c.erro("mensagem-feedback","Você precisa aceitar os Termos de Uso para continuar"),e("#termos").focus();return}k.loading(o,"Criar conta"),$.cadastrar({nome:n,email:t,senha:i}).then(function(f){c.sucesso("mensagem-feedback",`Conta criada com sucesso! Bem-vindo(a), ${f.nome}!`),setTimeout(function(){e("main").addClass("animate-exit"),setTimeout(function(){window.location.href="./dashboard.html"},300)},1e3)}).catch(function(f){let v="Erro ao criar conta. Tente novamente.";f.message==="Este e-mail já está cadastrado"?(v="Este e-mail já está cadastrado. Faça login ou use outro e-mail.",e("#email").addClass("input-error").focus()):f.statusText==="error"&&(v="Erro de conexão. Verifique se o servidor está rodando."),c.erro("mensagem-feedback",v),k.restaurar(o),a.addClass("animate-shake"),setTimeout(function(){a.removeClass("animate-shake")},500)})}),e(".input").on("focus",function(){e(this).closest(".form-control").addClass("scale-[1.01]")}).on("blur",function(){e(this).closest(".form-control").removeClass("scale-[1.01]")})});
