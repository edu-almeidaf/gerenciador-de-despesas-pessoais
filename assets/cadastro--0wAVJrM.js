import{$ as a,A as v}from"./auth-Dh7lbV3Z.js";import{V as t}from"./validacao-Df64VyJH.js";import{I as i,B as C,F as l}from"./input-C-Bf7OHr.js";function w(e,o,s){if(e.length===0){o.css("display","none");return}o.css("display","flex");const n=o.find("progress"),r=o.find("span");n.val(s.porcentagem),n.removeClass("progress-error").removeClass("progress-warning").removeClass("progress-success").addClass(`progress-${s.cor}`),r.text(s.nivel).removeClass("text-red-500").removeClass("text-yellow-600").removeClass("text-green-600"),s.cor==="error"?r.addClass("text-red-500"):s.cor==="warning"?r.addClass("text-yellow-600"):r.addClass("text-green-600")}function b(e,o){if(!o.length)return;o.removeClass("hidden");const s={tamanho:e.length>=6,letra:/[a-zA-Z]/.test(e),numero:/[0-9]/.test(e),especial:/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)};Object.keys(s).forEach(n=>{const r=a(`#req-${n}`);r.length&&(s[n]?(r.removeClass("text-zinc-400").addClass("text-green-600"),r.find("svg").html('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>')):(r.removeClass("text-green-600").addClass("text-zinc-400"),r.find("svg").html('<circle cx="12" cy="12" r="10"/>')))})}function S(e,o){e.css("display","none"),o.addClass("hidden")}const u={atualizarIndicador:w,atualizarRequisitos:b,esconderIndicadores:S},d={nome:!1,email:!1,senha:!1,confirmaSenha:!1};function g(){const e=a("#nome").val().trim(),o=a("#email").val().trim(),s=a("#password").val(),n=a("#confirm-password").val(),r=a("#termos").is(":checked"),c=e.length>0&&o.length>0&&s.length>0&&n.length>0&&r;a("#btn-submit").prop("disabled",!c)}function f(){const e=a("#password").val(),o=a("#confirm-password").val(),s=a("#confirm-password");if(o.length>0){const n=t.validarConfirmacaoSenha(e,o);n.valido?(i.marcarValido(s),d.confirmaSenha=!0):(i.mostrarErro(s,n.mensagem),d.confirmaSenha=!1)}}function x(){const e=a(this).val(),o=a(this),s=a("#senha-forca"),n=a("#senha-requisitos");if(i.limparErro(o),e.length===0){u.esconderIndicadores(s,n),d.senha=!1;return}const r=t.getForcaSenha(e);u.atualizarIndicador(e,s,r);const c=t.validarSenha(e,"medio");d.senha=c.valido,u.atualizarRequisitos(e,n),a("#confirm-password").val().length>0&&f()}function k(){const e=a(this).val(),o=a(this);if(e.length>0){const s=t.validarSenha(e,"medio");s.valido?i.marcarValido(o):i.mostrarErro(o,s.mensagem)}}function E(){i.limparErro(a(this)),f()}function V(){const e=a("#nome").val().trim(),o=a("#email").val().trim(),s=a("#password").val(),n=a("#confirm-password").val(),r=a("#termos").is(":checked");l.limpar("mensagem-feedback"),a(".input").removeClass("input-error");const c=t.validarNome(e);if(!c.valido)return l.erro("mensagem-feedback",c.mensagem),a("#nome").addClass("input-error").focus(),null;const m=t.validarEmail(o);if(!m.valido)return l.erro("mensagem-feedback",m.mensagem),a("#email").addClass("input-error").focus(),null;const h=t.validarSenha(s,"medio");if(!h.valido)return l.erro("mensagem-feedback",h.mensagem),a("#password").addClass("input-error").focus(),null;const p=t.validarConfirmacaoSenha(s,n);return p.valido?r?{nome:e,email:o,senha:s}:(l.erro("mensagem-feedback","Você precisa aceitar os Termos de Uso para continuar"),a("#termos").focus(),null):(l.erro("mensagem-feedback",p.mensagem),a("#confirm-password").addClass("input-error").focus(),null)}function y(e){l.sucesso("mensagem-feedback",`Conta criada com sucesso! Bem-vindo(a), ${e.nome}!`),setTimeout(function(){a("main").addClass("animate-exit"),setTimeout(function(){window.location.href="./dashboard.html"},300)},1e3)}function $(e,o,s){let n="Erro ao criar conta. Tente novamente.";e.message==="Este e-mail já está cadastrado"?(n="Este e-mail já está cadastrado. Faça login ou use outro e-mail.",a("#email").addClass("input-error").focus()):e.statusText==="error"&&(n="Erro de conexão. Verifique se o servidor está rodando."),l.erro("mensagem-feedback",n),C.restaurar(s),o.addClass("animate-shake"),setTimeout(function(){o.removeClass("animate-shake")},500)}async function I(e){e.preventDefault();const o=a(this),s=o.find('button[type="submit"]'),n=V();if(n){C.loading(s,"Criar conta");try{const r=await v.cadastrar(n);y(r)}catch(r){$(r,o,s)}}}function z(){a("#nome, #email, #password, #confirm-password").on("input",g),a("#termos").on("change",g),i.configurarValidacao(a("#nome"),t.validarNome,d,"nome"),i.configurarValidacao(a("#email"),t.validarEmail,d,"email"),a("#password").on("input",x),a("#password").on("blur",k),a("#confirm-password").on("input",E),a("#confirm-password").on("blur",f),a("#form-cadastro").on("submit",I),i.configurarEfeitoFoco(".input")}function T(){v.redirecionarSeLogado(),z()}a(document).ready(T);
